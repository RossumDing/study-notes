Consensus
共识

What is Consensus?
什么是共识？

Consensus is a state of agreement between the participants of a decentralized network. This means that the nodes on the network agree on the history and current state of the blockchain. State represents data such as the amount of CKBytes every user owns and which digital assets they have.
共识是去中心化网络参与者之间达成协议的一种状态。这意味着网络上的节点就区块链的历史和当前状态达成共识。状态代表数据，例如每个用户拥有的CKByte数量以及他们拥有的数字资产。

The Nervos Network has thousands of computers and millions of transactions that are constantly flowing through the network. The computers on the network must come to an agreement on which transactions are valid and the order in which they occurred. This is a challenge because nodes are positioned all over the world, and internet transmission isn’t instant or completely reliable.
Nervos网络拥有数以千计的计算机和数百万笔不断在网络中流动的交易。网络上的计算机必须就有效交易及其发生的顺序达成协议。这是一个挑战，因为节点遍布世界各地，并且互联网传输不是即时或完全可靠的。

Nodes pass messages to each other, sharing information about transactions and blocks that have been created. The messages might arrive out of order, or very late, or not at all. It also cannot be guaranteed that all of the nodes are functioning correctly or are being honest.
节点相互传递消息，共享有关已创建的事务和块的信息。消息可能乱序到达，或者很晚才到达，或者根本没有到达。也不能保证所有节点都正常运行或诚实。

Billions of dollars of value are at stake. The challenge is great, and robust solutions are of absolute importance.
数十亿美元的价值岌岌可危。挑战是巨大的，而可靠的解决方案是绝对重要的。

NC-Max
改良版的中本聪共识协议（Nakamoto Consensus）

A project as ambitious as Nervos requires a zero-compromise solution for consensus. Many options were considered and it was determined that Proof of Work (PoW) is still the best solution.
像Nervos一样雄心勃勃的项目需要零妥协的解决方案来达成共识。考虑了许多选择，并且确定工作量证明（PoW）仍然是最佳解决方案。

Proof of Stake (PoS) is one of the strongest contenders to PoW. The single greatest advantage PoS has is that it requires substantially less electricity to operate. However, PoW still offers several advantages over PoS:
权益证明（PoS）是PoW的最强竞争者之一。PoS的最大优点是，运行所需的电量大大减少。但是，与PoS相比，PoW仍具有一些优势：

- PoW mining is subject to external changes in technology, energy production, and regulation. This means that continued reinvestment is necessary to stay ahead of the competition, making long term monopolization difficult.
- PoW采矿受技术、能源生产和法规外部变化的影响。这意味着必须继续进行再投资才能保持竞争优势，从而使长期垄断变得困难。
- PoW does not give strong advantages to the early participants of the system. In PoS, rewards are attained completely deterministically, meaning there is no way for a late-comer to compete with an early participant.
- PoW并未给系统的早期参与者带来强大的优势。在PoS中，奖励是完全确定性地获得的，这意味着后来者无法与早期参与者竞争。
- PoW is more simplistic and requires far fewer assumptions to be made. This means the potential for security holes is substantially lower.
- PoW更简单，需要做的假设要少得多。这意味着安全漏洞的可能性大大降低。

Bitcoin’s Nakamoto Consensus is the PoW algorithm that has successfully defended Bitcoin from countless attacks for over a decade. The technology is well understood and proven through the test of time. Nervos’ NC-MAX builds on Nakamoto Consensus by improving block propagation, block throughput, and resistance to selfish mining.
比特币的《中本聪共识》是一种PoW算法，已经成功地防御了比特币十多年的无数次攻击。通过时间的考验，该技术已广为人知并得到了证明。Nervos的NC-MAX建立在中本聪共识的基础上，可改善区块传播、区块吞吐量和对自私采矿的抵抗力。

Improved Block Propagation
改进的块传播

When a transaction is broadcast to all the nodes on the network, it remains in queue until it is included in a future block. A bottleneck can occur when a transaction broadcast is not fully successful. Some nodes might be aware of the transaction, and others may not. If a block is broadcast to the network that includes a transaction that some of the nodes do not have, those nodes will need to sync the missing transactions before the block can be properly verified. This causes network delays as the missing transactions are found and distributed to all the nodes that need them.
当事务广播到网络上的所有节点时，它将一直处于队列中，直到将其包含在将来的块中为止。当事务广播未完全成功时，可能会出现瓶颈。一些节点可能知道该事务，而其他节点则可能不知道。如果将包含某些节点不具有的事务的块广播到网络，则在可以正确验证该块之前，这些节点将需要同步丢失的事务。当发现丢失的事务并将其分发给所有需要它们的节点时，这会导致网络延迟。

This bottleneck limits the performance of a blockchain because its impact becomes greater as the time between blocks is lowered. It can also lead to selfish mining attacks where miners intentionally create network delays to give themselves a slight advantage over other participants to gain more mining rewards.
这个瓶颈限制了区块链的性能，因为随着区块之间的时间缩短，其影响会越来越大。这也可能导致自私的采矿攻击，在这种攻击中，矿工有意造成网络延迟，从而使自己比其他参与者略有优势，从而获得了更多的采矿奖励。

NC-MAX solves this by splitting the confirmation process into two steps: propose and commit. A transaction is first proposed to the network. A proposed transaction cannot be confirmed until several blocks later. This gives more time for transaction propagation without slowing down block propagation. Once a transaction has been proposed and fully propagated, then it can be committed. This eliminates transaction propagation as a delay factor to block propagation, eliminating the bottleneck and selfish mining attack.
NC-MAX通过将确认过程分为两个步骤来解决此问题：提议和提交。首先向网络提出交易。直到数个区块之后，才能确认提议的交易。这为事务传播提供了更多时间，而不会减慢块传播。一旦提出并完全传播了交易，就可以提交该交易。这消除了交易传播作为阻止传播的延迟因素，消除了瓶颈和自私的采矿攻击。

Improved Block Throughput
改进的吞吐量

A shorter block interval results in blocks being created more frequently. This results in faster transaction confirmation and higher throughput for the network. The downside of a lower block interval is that internet congestion has a greater effect on the ability of the network to properly synchronize. Blocks are sometimes created while the network not fully in sync, creating what is known as an Orphan Block. This means that the efforts towards network security are temporarily divided. Having some Orphan Blocks is unavoidable, but if too many occur in a short period it becomes counterproductive.
较短的块间隔会导致更频繁地创建块。这导致更快的交易确认和更高的网络吞吐量。较短的块间隔缺点是，互联网拥塞会对网络正确同步的能力产生更大的影响。有时会在网络未完全同步时创建块，从而创建了所谓的“孤立块”。这意味着在网络安全方面的工作暂时被划分了。不可避免地会有一些孤立块，但是如果在短时间内出现太多孤立块，则会适得其反。

NC-MAX improves this by automatically adjusting the block interval based on network performance. The number of Orphan Blocks created within a time frame is tracked and taken into consideration by the consensus protocol. The network is then able to adjust the block interval to maximize throughput while maintaining an expected Orphan Rate. This results in dramatically shorter block times without sacrificing security.
NC-MAX通过根据网络性能自动调整块间隔来改善这一点。共识协议会跟踪并考虑在一个时间范围内创建的孤立块的数量。然后，网络能够调整块间隔以最大化吞吐量，同时保持预期的孤立率。这样可以在不牺牲安全性的情况下大大缩短块时间。

Improved Resistance to Selfish Mining
增强对自私采矿的抵抗力

Selfish mining is a practice where certain miners are able to secretly gain a larger share of mining rewards while contributing less hash power to the network. This is discouraged because it weakens the overall network security and can lead to irregular block times while causing congestion problems.
自私的挖矿是一种实践，其中某些矿工能够秘密地获得更大份额的挖矿奖励，同时为网络贡献更少的哈希值。不建议这样做，因为它会削弱整个网络的安全性，并可能导致不规则的阻塞时间，同时导致拥塞问题。

NC-MAX offers the most accurate measurement of the network’s computing power by taking into account both external and internal factors. This new model makes all known selfish mining attacks unprofitable because the actions they would perform to exploit the computing power calculation are now properly accounted for.
NC-MAX通过考虑外部和内部因素，提供对网络计算能力的最精确测量。这种新模型使所有已知的自私挖矿攻击均无济于事，因为现在可以正确考虑它们为利用计算能力计算而执行的操作。

Eaglesong
Eaglesong算法

Bitcoin’s Nakamoto Consensus internally utilizes a well-known hashing function known as SHA256. The majority of mining infrastructure that exists in the world is based around this algorithm.
比特币的《中本聪共识》内部利用了众所周知的哈希函数SHA256。世界上存在的大多数采矿基础设施都基于此算法。

Any new cryptocurrency that is also based on SHA256 immediately benefits from hardware availability. However, there is a downside in that the substantial amount of infrastructure available for a large cryptocurrency, like Bitcoin, can be used maliciously towards a small cryptocurrency during their early days. Having dedicated mining hardware available for your ecosystem is overall beneficial since it significantly increases the challenges of attacking the network. For these reasons, a new cryptographic hashing function was created specifically for Nervos, called Eaglesong.
任何也基于SHA256的新加密货币都会立即受益于硬件可用性。但缺点是，可用于大型加密货币（例如比特币）的大量基础架构在早期阶段就可以恶意地用于小型加密货币。为您的生态系统提供专用的挖掘硬件总体上是有利的，因为它显着增加了攻击网络的挑战。由于这些原因，专门为Nervos创建了一个新的加密散列函数，称为Eaglesong。

Eaglesong successfully blends novelty, simplicity, and security in a way that is easily implemented in both software and hardware. This advancement gives Nervos an edge in blockchain security while allowing for complete hardware sovereignty.
Eaglesong以易于在软件和硬件中实现的方式成功地融合了新颖性、简单性和安全性。这项进步使Nervos在区块链安全性方面具有优势，同时允许完整的硬件主权。

Further Reading
进一步阅读

For more information on the topic of consensus, please see the Consensus Protocol RFC.
有关共识主题的更多信息，请参阅共识协议RFC。
（https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0020-ckb-consensus-protocol/0020-ckb-consensus-protocol.md）
For more information on the Eaglesong algorithm, please see the Eaglesong RFC.
有关Eaglesong算法的更多信息，请参见Eaglesong RFC。
（https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0010-eaglesong/0010-eaglesong.md）
